<html>
<head>
<meta charset="ISO-8859-1">
<title>Test de servicios</title>
<link href="css/jquery-ui.css" rel="stylesheet">
<script src="js/jquery.min.js"></script>
<script src="js/jquery-ui.js"></script>
<script type="text/javascript">

function jack() {
    var username = 'clientapp'; // Nombre de usuario que deseas autenticar

    // Realizar la solicitud AJAX al endpoint /auth/authenticate
    var results = $.ajax({
        url: '/rest_accreditation-0.0.1-SNAPSHOT/auth/authenticate',
        type: 'POST',
        data: {
            'username': username // Pasar el nombre de usuario como parte de los datos de la solicitud
        },
        dataType: 'json', // Esperamos una respuesta JSON
        success: function(response) {
            // Manejar la respuesta exitosa
			
            $('#token').val(response.jwt); 
        },
        error: function(xhr, status, error) {
            // Manejar errores de la solicitud
			
            console.error('Error al autenticar:', error);
        }
    });

    // Devolver el objeto de resultados de la solicitud AJAX
    return results;
}

	function ConsultaVisitantes(){
		
		var token= $('#token').val();
		var doc= $('#docVis').val();
		var nombres= $('#nombVis').val();
		var apellidos= $('#apelliVis').val();
		var ubicacion= $('#ubiVis').val().toUpperCase();
		
		var results = $.ajax({

	        // The URL to process the request
	        url : '/rest_accreditation-0.0.1-SNAPSHOT/visitantes/getDatosVisitantes',
	        type : 'GET',
	        data : {
	        	doc : doc,
	        	nombres : nombres,
	        	apellidos : apellidos,
	        	ubicacion : ubicacion,
	        },
			headers: {
			    "Authorization": "Bearer "+token
		    },
	        dataType: "json",
	        success: function(response) {
	           $("#responseVisitantes").val( JSON.stringify(response, null, 4));
			   
	        }, error: function(error){
	            console.log(error);
				
				
				
	        }

	    });
		
	}
	
</script>
</head>
<body>

		<div class="main">
			<h2>Pagina de Pruebas de Servicios</h2>
			<div>
				<p>
					<input type="button" class="btn btn-default" id="reset" name="reset"  value="Obtener token" onclick="jack()"/>
				</p>
				<p>	
					<textarea rows="4" cols="50" id="token"></textarea>
				</p>			
			</div>			
			<div class="tabs standard">
				<ul class="tab-links">
					<li class="active">
						<a href="#tab13">Datos Visitantes</a>
					</li>				
				</ul>
				<div class="tab-content">
					<div id="tab13" class="tab active">
						<p>Documento: <input type="text" id="docVis"></p>
						<p>Nombres: <input type="text" id="nombVis"></p>
						<p>Apellidos: <input type="text" id="apelliVis"></p>
						<p>Ubicacion: <input type="text" id="ubiVis"></p>
						<p><input type="button" class="btn btn-default" id="consulVisitantes" name="consulVisitantes" value="Consultar" onclick="ConsultaVisitantes()"/></p>
						<p><textarea rows="80" cols="50" id="responseVisitantes"></textarea></p>												
					</div>
				</div>
			</div>
		</div>
		
</body>
</html>		